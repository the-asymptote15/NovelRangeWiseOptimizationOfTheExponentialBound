points = 75;
z = linspace(0,5,points);

% Prony 2 approximation:
erfcz1 = (0.416)*(exp(-(1.942)*(z.^2))) + (0.294)*(exp(-(1.05)*(z.^2)));
RE1 = ((abs(erfc(z)- erfcz1)) ./ erfc(z)) * 100 ; % element wise array operation

semilogy(z,RE1,'color','#A2142F','linewidth',2);
hold on
xlabel('x');
ylabel('RE');
axis([0 5 10^(-3) 10^(2)]);
xticks([0 1 2 3 4 5])
yticks([10^(-5) 10^(-4) 10^(-3) 10^(-2) 10^(-1) 10^0 10^1 10^2])

% Prony 3 approximation:
erfcz2 = (0.336)*(exp(-(1.752)*(z.^2))) + (0.288)*(exp(-(1.05)*(z.^2))) + ((0.004)*exp(-(1.206)*(z.^2)));
RE2 = ((abs(erfc(z) - erfcz2)) ./ erfc(z)) * 100;
semilogy(z,RE2,'g-s','linewidth',1);

% Q. Shi and Y. Karasawa approximations:
erfcz3 = (2/(sqrt(pi)))*exp(-(z.^2)).*(0.6405 *exp(-(0.4245 *(sqrt(2)).*z))+ 0.2457 *exp(-(1.7711*sqrt(2)).*z));
RE3 = ((abs(erfc(z) - erfcz3)) ./ erfc(z)) * 100;
semilogy(z,RE3,'linewidth',2);

% n=2 Olabiyi approximation:
erfcz4 = (0.3017*exp(-(1.051*(z.^2))) + 0.4389*exp(-(2.102*(z.^2))));
RE4 = ((abs(erfc(z) - erfcz4)) ./ erfc(z)) * 100;
semilogy(z,RE4,'c-^','linewidth',1);

% n=3 Olabiyi approximation:
erfcz5 = (0.3357*(exp(-(1.0648*(z.^2))))) + (0.3361*(exp(-(2.1298*(z.^2))))) + (0.0305*(exp(-(3.1946*(z.^2)))));
RE5 = ((abs(erfc(z) - erfcz5)) ./ erfc(z)) * 100;
semilogy(z,RE5,'m-d','linewidth',1);

% optimised curve N = 3:
ERFC = erfc(z); 
syms y(x)
y(x) = piecewise( ((0<=x)&(x<0.04338)),(0.2222)*(exp(-(x.^2))) + (0.3889)*(exp(-4*(x.^2))) + (0.3889)*(exp((-4/3)*(x.^2))),((0.04338<=x)&(x<0.1602)),(0.1919)*(exp(-(x.^2))) + (0.3578)*(exp(-4*(x.^2))) + (0.3585)*(exp((-4/3)*(x.^2))),(0.1602<=x)&(x<0.2903),(0.1665)*(exp(-(x.^2))) + (0.3332)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))),((0.2903<=x)&(x<0.6007)),(0.1594)*(exp(-(x.^2))) + (0.3299)*(exp(-4*(x.^2))) + (0.3266)*(exp((-4/3)*(x.^2))),((0.6007<=x)&(x<0.7575)),(0.1664)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),((0.7575<=x)&(x<1.135)),(0.1703)*(exp(-(x.^2))) + (0.3335)*(exp(-4*(x.^2))) + (0.3359)*(exp((-4/3)*(x.^2))),((1.135<=x) &(x<1.335)),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3334)*(exp((-4/3)*(x.^2))),((1.335<=x)&(x<1.795)),(0.1643)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3322)*(exp((-4/3)*(x.^2))),(1.795<=x)&(x<1.959),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),((1.959<=x)&(x<2.096)),(0.1675)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3335)*(exp((-4/3)*(x.^2))),(2.096<=x)&(x<2.646),(0.1693)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3336)*(exp((-4/3)*(x.^2))),(2.646<=x)&(x<2.887),(0.1669)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),(2.8887<=x)&(x<3.654),(0.1624)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),(3.654<=x)&(x<=5),(0.1285)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))));
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx


RE6 = [];
for i = 1:points
    temp = ((abs(ERFC(i) - y(i)))/ERFC(i) ) * 100;
    RE6 = horzcat(RE6,temp);
end

semilogy(z,RE6,'b-*','linewidth',1);

% optimised curve N = 4:

syms y(x)
y(x) = piecewise( ((0<=x)&(x<0.04338)),((0.1562)*(exp(-(x.^2)))) + ((0.2812)*(exp(-(2*(x.^2))))) + ((0.2812)*(exp(-((20/3)*(x.^2))))) + ((0.2812)*(exp(-((20/17)*(x.^2))))),((0.04338<=x)&(x<0.1368)),((0.1348)*(exp(-(x.^2)))) + ((0.2597)*(exp(-(2*(x.^2))))) + ((0.2593)*(exp(-((20/3)*(x.^2))))) + ((0.2598)*(exp(-((20/17)*(x.^2))))),((0.1368<=x)&(x<0.2102)),((0.1249)*(exp(-(x.^2)))) + ((0.2499)*(exp(-(2*(x.^2))))) + ((0.2499)*(exp(-((20/3)*(x.^2))))) + ((0.2499)*(exp(-((20/17)*(x.^2))))),((0.2102<=x)&(x<0.4505)),((0.1213)*(exp(-(x.^2)))) + ((0.2465)*(exp(-(2*(x.^2))))) + ((0.2474)*(exp(-((20/3)*(x.^2))))) + ((0.2464)*(exp(-((20/17)*(x.^2))))),((0.4505<=x)&(x<0.5306)),((0.1235)*(exp(-(x.^2)))) + ((0.2488)*(exp(-(2*(x.^2))))) + ((0.2496)*(exp(-((20/3)*(x.^2))))) + ((0.2485)*(exp(-((20/17)*(x.^2))))),((0.5306<=x)&(x<0.604)),((0.12499)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((0.604<=x)&(x<0.8343)),((0.1263)*(exp(-(x.^2)))) + ((0.2507)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2511)*(exp(-((20/17)*(x.^2))))),((0.8343<=x)&(x<0.9377)),((0.1256)*(exp(-(x.^2)))) + ((0.2503)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((0.9377<=x)&(x<1.198)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((1.198<=x)&(x<1.34)),((0.1253)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2502)*(exp(-((20/17)*(x.^2))))),((1.34<=x)&(x<1.518)),((0.1264)*(exp(-(x.^2)))) + ((0.2501)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((1.518<=x)&(x<2.614)),((0.1269)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((2.614<=x)&(x<3.521)),((0.1277)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((3.521<=x)&(x<=4.016)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((4.016<=x)&(x<=5)),((0.1190)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2497)*(exp(-((20/17)*(x.^2))))) );
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx
ERFC = erfc(z);     % actual erfc
RE7 = [];
for i = 1:points
    temp = (((abs(ERFC(i) - y(i))) )/ERFC(i)) * 100;
    RE7 = horzcat(RE7,temp);
end

semilogy(z,RE7,'r-*','linewidth',1);

%LEGEND:
h = legend('Ref. [10, p = 2] ','Ref. [10, p = 3] ','Ref. [13, N = 2] ','Ref. [15, n = 2] ','Ref. [15, n = 3] ','Optimized n=3','Optimized n=4');
%set(h,'location','best');
set(h,'location','southeastoutside');
set(gca,'FontSize',50) % Axis Font Setting

hold off