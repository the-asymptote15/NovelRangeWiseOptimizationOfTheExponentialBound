points = 75;
z = linspace(0,5,points);
ERFC = erfc(z);          % original erfc


%composite midpoint rule of Gauss n=4 :

erfcz1 = ((1/4)*(exp(-(26.2743*(z.^2))))) + ((1/4)*(exp(-(3.2398*(z.^2))))) + ((1/4)*(exp(-(1.4464*(z.^2)))))+((1/4)*(exp(-(1.03957*(z.^2)))));


% Relative Error calculation:
RE1 = ((abs(erfc(z)- erfcz1)) ./ erfc(z) ) * 100 ; 
semilogy(z,RE1,'g','linewidth',2);
hold on
xlabel('x');
ylabel('RE');
axis([0 5 10^(-3) 10^(2)]);
xticks([0  1  2  3  4 5])
yticks([10^(-5) 10^(-4) 10^(-3) 10^(-2) 10^(-1) 10^0 10^1 10^2])

% GLOBAL MAX MIN N = 4:
%{[0.142185191278318,0.164019803143814,0.137905453783753,0.0558895517941150]}    BN {[0.525146776881201,0.852967173039587,3.76727623960861,98.0485118999129]}

erfcz2 = 2 * ( (  0.142185191278318 .* ( exp(-( (2 * 0.525146776881201) .* (z.^2) ) ) ) ) + ( 0.164019803143814 .* ( exp(-( (2 * 0.852967173039587) .* (z.^2) ) ) ) ) + ( 0.137905453783753 .* ( exp(-( (2 * 3.76727623960861) .* (z.^2) ) ) ) ) + ( 0.0558895517941150 .* ( exp(-( (2 * 98.0485118999129) .* (z.^2) ) ) ) ) );

RE2 = ((abs(erfc(z) - erfcz2)) ./ erfc(z)) * 100;
semilogy(z,RE2,'c','linewidth',2);

% %GLOBAL MIN MAX N = 5:
% erfcz3 = 2 * ( (  0.4920547396876422 .* ( exp(-( (2 * 0.5982476003750250) .* (z.^2) ) ) ) ) + ( 0.1587491012166297 .* ( exp(-( (2 * 2.024383866054074) .* (z.^2) ) ) ) ) + ( 0.06460001610510117 .* ( exp(-( (2 * 13.23465438792062) .* (z.^2) ) ) ) ) + ( 0.02567521272080907 .* ( exp(-( (2 * 131.4581690889673) .* (z.^2) ) ) ) ) + ( 0.008236936034796302 .* ( exp(-( (2 * 3210.202445024321) .* (z.^2) ) ) ) ) );
% RE3 = ((abs(erfc(z) - erfcz3)) ./ erfc(z)) * 100;
% semilogy(z,RE3,'color','#A2142F','linewidth',2);

% optimised curve:

syms y(x)
y(x) = piecewise( ((0<=x)&(x<0.04338)),((0.1562)*(exp(-(x.^2)))) + ((0.2812)*(exp(-(2*(x.^2))))) + ((0.2812)*(exp(-((20/3)*(x.^2))))) + ((0.2812)*(exp(-((20/17)*(x.^2))))),((0.04338<=x)&(x<0.1368)),((0.1348)*(exp(-(x.^2)))) + ((0.2597)*(exp(-(2*(x.^2))))) + ((0.2593)*(exp(-((20/3)*(x.^2))))) + ((0.2598)*(exp(-((20/17)*(x.^2))))),((0.1368<=x)&(x<0.2102)),((0.1249)*(exp(-(x.^2)))) + ((0.2499)*(exp(-(2*(x.^2))))) + ((0.2499)*(exp(-((20/3)*(x.^2))))) + ((0.2499)*(exp(-((20/17)*(x.^2))))),((0.2102<=x)&(x<0.4505)),((0.1213)*(exp(-(x.^2)))) + ((0.2465)*(exp(-(2*(x.^2))))) + ((0.2474)*(exp(-((20/3)*(x.^2))))) + ((0.2464)*(exp(-((20/17)*(x.^2))))),((0.4505<=x)&(x<0.5306)),((0.1235)*(exp(-(x.^2)))) + ((0.2488)*(exp(-(2*(x.^2))))) + ((0.2496)*(exp(-((20/3)*(x.^2))))) + ((0.2485)*(exp(-((20/17)*(x.^2))))),((0.5306<=x)&(x<0.604)),((0.12499)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((0.604<=x)&(x<0.8343)),((0.1263)*(exp(-(x.^2)))) + ((0.2507)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2511)*(exp(-((20/17)*(x.^2))))),((0.8343<=x)&(x<0.9377)),((0.1256)*(exp(-(x.^2)))) + ((0.2503)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((0.9377<=x)&(x<1.198)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((1.198<=x)&(x<1.34)),((0.1253)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2502)*(exp(-((20/17)*(x.^2))))),((1.34<=x)&(x<1.518)),((0.1264)*(exp(-(x.^2)))) + ((0.2501)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((1.518<=x)&(x<2.614)),((0.1269)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((2.614<=x)&(x<3.521)),((0.1277)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((3.521<=x)&(x<=4.016)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((4.016<=x)&(x<=5)),((0.1190)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2497)*(exp(-((20/17)*(x.^2))))) );
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx
ERFC = erfc(z);     % actual erfc
RE4 = [];
for i = 1:points
    temp = (((abs(ERFC(i) - y(i))) )/ERFC(i)) * 100;
    RE4 = horzcat(RE4,temp);
end

semilogy(z,RE4,'r-*','linewidth',1);

%Legend of the plot:
h=legend('Ref. [23, n = 4] ' ,'Ref. [19, N = 4]','Optimized n = 4');
set(h,'location','southeastoutside');
set(gca,'FontSize',50)

hold off