points = 70;
z = linspace(0,5,points);
ERFC = erfc(z);          % original erfc



%composite midpoint rule of Gauss n=3 :

erfcz1 = ((1/3)*(exp(-(14.9304*(z.^2))))) + ((1/3)*(exp(-(2*(z.^2))))) + (1/3)*(exp((-1.0717)*(z.^2)));

% Relative Error calculation:
RE1 = ((abs(erfc(z)- erfcz1)) ./ erfc(z) ) * 100 ; % element wise array operation

semilogy(z,RE1,'g','linewidth',2);
hold on
xlabel('x');
ylabel('RE');
axis([0 5 10^(-2) 10^(2)]);
xticks([0  1  2  3  4  5])
yticks([ 10^(-2) 10^(-1) 10^0 10^1 10^2])


%GLOBAL MAX MIN N = 3:
%{[0.160031397648051,0.206831828787707,0.133136773564242]}  BN {[0.530835654255633,1.07637865555060,15.8353402897188]}
erfcz2 = 2 * ( ( 0.160031397648051 .* ( exp(-( (2 * 0.530835654255633) .* (z.^2) ) ) ) ) + ( 0.206831828787707 .* ( exp(-( (2 * 1.07637865555060) .* (z.^2) ) ) ) ) + ( 0.133136773564242 .* ( exp(-( (2 * 15.8353402897188) .* (z.^2) ) ) ) ) );

% Relative Error calculation:
RE2 = ((abs(erfc(z)- erfcz2)) ./ erfc(z) ) * 100 ; % element wise array operation

semilogy(z,RE2,'c','linewidth',2);

% QUAD N = 3:

erfcz3 = (1.1142/pi)*(exp(-13.226*(z.^2))) + (1.0262/pi)*(exp(-1.893*(z.^2))) + (1.00119/pi)*(exp(-1.06536*(z.^2)));

% Relative Error calculation:
RE3 = ((abs(erfc(z)- erfcz3)) ./ erfc(z) ) * 100 ; % element wise array operation

semilogy(z,RE3,'m','linewidth',2);


% optimised curve:

syms y(x)
%y(x) = piecewise( ((0<=x)&(x<0.04338)),(0.2222)*(exp(-(x.^2))) + (0.3889)*(exp(-4*(x.^2))) + (0.3889)*(exp((-4/3)*(x.^2))),((0.04338<=x)&(x<0.1602)),(0.1919)*(exp(-(x.^2))) + (0.3578)*(exp(-4*(x.^2))) + (0.3585)*(exp((-4/3)*(x.^2))),(0.1602<=x)&(x<0.2903),(0.1665)*(exp(-(x.^2))) + (0.3332)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))),((0.2903<=x)&(x<0.6007)),(0.1594)*(exp(-(x.^2))) + (0.3299)*(exp(-4*(x.^2))) + (0.3266)*(exp((-4/3)*(x.^2))),((0.6007<=x)&(x<0.7575)),(0.1664)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),((0.7575<=x)&(x<1.135)),(0.1703)*(exp(-(x.^2))) + (0.3335)*(exp(-4*(x.^2))) + (0.3359)*(exp((-4/3)*(x.^2))),((1.135<=x) &(x<1.335)),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3334)*(exp((-4/3)*(x.^2))),((1.335<=x)&(x<1.795)),(0.1643)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3322)*(exp((-4/3)*(x.^2))),(1.795<=x)&(x<1.959),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),((1.959<=x)&(x<2.096)),(0.1675)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3335)*(exp((-4/3)*(x.^2))),(2.096<=x)&(x<2.646),(0.1693)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3336)*(exp((-4/3)*(x.^2))),(2.646<=x)&(x<2.887),(0.1669)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),(2.8887<=x)&(x<=5),(0.1624)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))));
y(x) = piecewise( ((0<=x)&(x<0.04338)),(0.2222)*(exp(-(x.^2))) + (0.3889)*(exp(-4*(x.^2))) + (0.3889)*(exp((-4/3)*(x.^2))),((0.04338<=x)&(x<0.1602)),(0.1919)*(exp(-(x.^2))) + (0.3578)*(exp(-4*(x.^2))) + (0.3585)*(exp((-4/3)*(x.^2))),(0.1602<=x)&(x<0.2903),(0.1665)*(exp(-(x.^2))) + (0.3332)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))),((0.2903<=x)&(x<0.6007)),(0.1594)*(exp(-(x.^2))) + (0.3299)*(exp(-4*(x.^2))) + (0.3266)*(exp((-4/3)*(x.^2))),((0.6007<=x)&(x<0.7575)),(0.1664)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),((0.7575<=x)&(x<1.135)),(0.1703)*(exp(-(x.^2))) + (0.3335)*(exp(-4*(x.^2))) + (0.3359)*(exp((-4/3)*(x.^2))),((1.135<=x) &(x<1.335)),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3334)*(exp((-4/3)*(x.^2))),((1.335<=x)&(x<1.795)),(0.1643)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3322)*(exp((-4/3)*(x.^2))),(1.795<=x)&(x<1.959),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),((1.959<=x)&(x<2.096)),(0.1675)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3335)*(exp((-4/3)*(x.^2))),(2.096<=x)&(x<2.646),(0.1693)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3336)*(exp((-4/3)*(x.^2))),(2.646<=x)&(x<2.887),(0.1669)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),(2.8887<=x)&(x<3.654),(0.1624)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),(3.654<=x)&(x<=5),(0.1285)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))));
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx


RE4 = [];
for i = 1:points
    temp = ((abs(ERFC(i) - y(i)))/ERFC(i) ) * 100;
    RE4 = horzcat(RE4,temp);
end


semilogy(z,RE4,'b*-','linewidth',1);

%Legend of the plot:
h=legend('Ref. [23, n = 3] ' ,'Ref. [19, N = 3]','Ref. [20, N = 3]','Optimized n = 3');
set(h,'location','southeastoutside');
set(gca,'FontSize',50)

hold off