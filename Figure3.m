points = 75;
z = linspace(0,5,points);
ERFC = erfc(z);          % original erfc

%--------------------------------------------------------------------------
%original karagiannidis:
erfcz1 = ((1 -(exp((-1.98).*(z)))) .* exp(-(z.^2))) ./ ((1.135)*sqrt(pi).*(z));
RE1 = ((abs(erfc(z)- erfcz1)) ./ erfc(z)) * 100 ; % element wise array operation 
semilogy(z,RE1,'c','linewidth',2);
hold on
xlabel('x');
ylabel('RE');
axis([0 5 10^(-3) 10^(2)]);
xticks([0  1  2  3  4  5])
yticks([10^(-4) 10^(-3) 10^(-2) 10^(-1) 10^0 10^1 10^2])
%--------------------------------------------------------------------------
% %optimized karagiannidis 1:
% a = 0.3760; b = 0.5; c = 1.3293;
% erfcz2 = (sqrt(2)*a)*exp(-(2*b*(z.^2))).*((1-exp(-(c*sqrt(2)*z)))/z);
% RE2 = ((abs(erfc(z)- erfcz2)) ./ erfc(z) ) * 100 ; 
% Case 1:
%A = 1.95 ; B = 1.113;

erfcx2 = ((1 -(exp((-1.95).*(z)))) .* exp(-(z.^2))) ./ ((1.113)*sqrt(pi).*(z));
RE2 = ((abs(erfc(z)- erfcx2)) ./ erfc(z) ) * 100 ; % element wise array operation
RE2(1) = 1; 
MRE1 = sum(RE2)/300;
semilogy(z,RE2,'color','#EDB120','linewidth',2);
%--------------------------------------------------------------------------
%optimized karagiannidis 2:
% a =  0.3200; b = 0.4703; c = 1.5625;
% erfcz3 = (sqrt(2)*a)*exp(-(2*b*(z.^2))).*((1-exp(-(c*sqrt(2)*z)))/z);
% RE3 = ((abs(erfc(z)- erfcz3)) ./ erfc(z) ) * 100 ; 
% Case 3: 
%A = 1.88; B = 1.061;

erfcx4 = ((1 -(exp((-1.88).*(z)))) .* exp(-(z.^2))) ./ ((1.061)*sqrt(pi).*(z));
RE4 = ((abs(erfc(z)- erfcx4)) ./ erfc(z) ) * 100 ; % element wise array operation
RE4(1) = 1;
MRE2 = sum(RE4)/300;


semilogy(z,RE4,'g','linewidth',2);
%--------------------------------------------------------------------------
% optimised curve N = 3:
  
syms y(x)
%y(x) = piecewise( ((0<=x)&(x<0.04338)),(0.2222)*(exp(-(x.^2))) + (0.3889)*(exp(-4*(x.^2))) + (0.3889)*(exp((-4/3)*(x.^2))),((0.04338<=x)&(x<0.1602)),(0.1919)*(exp(-(x.^2))) + (0.3578)*(exp(-4*(x.^2))) + (0.3585)*(exp((-4/3)*(x.^2))),(0.1602<=x)&(x<0.2903),(0.1665)*(exp(-(x.^2))) + (0.3332)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))),((0.2903<=x)&(x<0.6007)),(0.1594)*(exp(-(x.^2))) + (0.3299)*(exp(-4*(x.^2))) + (0.3266)*(exp((-4/3)*(x.^2))),((0.6007<=x)&(x<0.7575)),(0.1664)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),((0.7575<=x)&(x<1.135)),(0.1703)*(exp(-(x.^2))) + (0.3335)*(exp(-4*(x.^2))) + (0.3359)*(exp((-4/3)*(x.^2))),((1.135<=x) &(x<1.335)),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3334)*(exp((-4/3)*(x.^2))),((1.335<=x)&(x<1.795)),(0.1643)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3322)*(exp((-4/3)*(x.^2))),(1.795<=x)&(x<1.959),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),((1.959<=x)&(x<2.096)),(0.1675)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3335)*(exp((-4/3)*(x.^2))),(2.096<=x)&(x<2.646),(0.1693)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3336)*(exp((-4/3)*(x.^2))),(2.646<=x)&(x<2.887),(0.1669)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),(2.8887<=x)&(x<=5),(0.1624)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))));
y(x) = piecewise( ((0<=x)&(x<0.04338)),(0.2222)*(exp(-(x.^2))) + (0.3889)*(exp(-4*(x.^2))) + (0.3889)*(exp((-4/3)*(x.^2))),((0.04338<=x)&(x<0.1602)),(0.1919)*(exp(-(x.^2))) + (0.3578)*(exp(-4*(x.^2))) + (0.3585)*(exp((-4/3)*(x.^2))),(0.1602<=x)&(x<0.2903),(0.1665)*(exp(-(x.^2))) + (0.3332)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))),((0.2903<=x)&(x<0.6007)),(0.1594)*(exp(-(x.^2))) + (0.3299)*(exp(-4*(x.^2))) + (0.3266)*(exp((-4/3)*(x.^2))),((0.6007<=x)&(x<0.7575)),(0.1664)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),((0.7575<=x)&(x<1.135)),(0.1703)*(exp(-(x.^2))) + (0.3335)*(exp(-4*(x.^2))) + (0.3359)*(exp((-4/3)*(x.^2))),((1.135<=x) &(x<1.335)),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3334)*(exp((-4/3)*(x.^2))),((1.335<=x)&(x<1.795)),(0.1643)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3322)*(exp((-4/3)*(x.^2))),(1.795<=x)&(x<1.959),(0.1667)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),((1.959<=x)&(x<2.096)),(0.1675)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3335)*(exp((-4/3)*(x.^2))),(2.096<=x)&(x<2.646),(0.1693)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3336)*(exp((-4/3)*(x.^2))),(2.646<=x)&(x<2.887),(0.1669)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3333)*(exp((-4/3)*(x.^2))),(2.8887<=x)&(x<3.654),(0.1624)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3331)*(exp((-4/3)*(x.^2))),(3.654<=x)&(x<=5),(0.1285)*(exp(-(x.^2))) + (0.3333)*(exp(-4*(x.^2))) + (0.3332)*(exp((-4/3)*(x.^2))));
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx


RE5 = [];
for i = 1:points
    temp = ((abs(ERFC(i) - y(i)))/ERFC(i) ) * 100;
    RE5 = horzcat(RE5,temp);
end

semilogy(z,RE5,'b-*','linewidth',1);

% optimised curve N = 4:
points = 75;
syms y(x)
y(x) = piecewise( ((0<=x)&(x<0.04338)),((0.1562)*(exp(-(x.^2)))) + ((0.2812)*(exp(-(2*(x.^2))))) + ((0.2812)*(exp(-((20/3)*(x.^2))))) + ((0.2812)*(exp(-((20/17)*(x.^2))))),((0.04338<=x)&(x<0.1368)),((0.1348)*(exp(-(x.^2)))) + ((0.2597)*(exp(-(2*(x.^2))))) + ((0.2593)*(exp(-((20/3)*(x.^2))))) + ((0.2598)*(exp(-((20/17)*(x.^2))))),((0.1368<=x)&(x<0.2102)),((0.1249)*(exp(-(x.^2)))) + ((0.2499)*(exp(-(2*(x.^2))))) + ((0.2499)*(exp(-((20/3)*(x.^2))))) + ((0.2499)*(exp(-((20/17)*(x.^2))))),((0.2102<=x)&(x<0.4505)),((0.1213)*(exp(-(x.^2)))) + ((0.2465)*(exp(-(2*(x.^2))))) + ((0.2474)*(exp(-((20/3)*(x.^2))))) + ((0.2464)*(exp(-((20/17)*(x.^2))))),((0.4505<=x)&(x<0.5306)),((0.1235)*(exp(-(x.^2)))) + ((0.2488)*(exp(-(2*(x.^2))))) + ((0.2496)*(exp(-((20/3)*(x.^2))))) + ((0.2485)*(exp(-((20/17)*(x.^2))))),((0.5306<=x)&(x<0.604)),((0.12499)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((0.604<=x)&(x<0.8343)),((0.1263)*(exp(-(x.^2)))) + ((0.2507)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2511)*(exp(-((20/17)*(x.^2))))),((0.8343<=x)&(x<0.9377)),((0.1256)*(exp(-(x.^2)))) + ((0.2503)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((0.9377<=x)&(x<1.198)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((1.198<=x)&(x<1.34)),((0.1253)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2502)*(exp(-((20/17)*(x.^2))))),((1.34<=x)&(x<1.518)),((0.1264)*(exp(-(x.^2)))) + ((0.2501)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((1.518<=x)&(x<2.614)),((0.1269)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2509)*(exp(-((20/17)*(x.^2))))),((2.614<=x)&(x<3.521)),((0.1277)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2505)*(exp(-((20/17)*(x.^2))))),((3.521<=x)&(x<=4.016)),((0.1250)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2500)*(exp(-((20/17)*(x.^2))))),((4.016<=x)&(x<=5)),((0.1190)*(exp(-(x.^2)))) + ((0.2500)*(exp(-(2*(x.^2))))) + ((0.2500)*(exp(-((20/3)*(x.^2))))) + ((0.2497)*(exp(-((20/17)*(x.^2))))) );
xvalues = linspace(0,5,points);
yvalues = y(xvalues);
y = double(yvalues);     % optimized values of trapezoidal approx
ERFC = erfc(z);     % actual erfc
RE6 = [];
for i = 1:points
    temp = (((abs(ERFC(i) - y(i))) )/ERFC(i)) * 100;
    RE6 = horzcat(RE6,temp);
end

semilogy(z,RE6,'r-*','linewidth',1);

%LEGEND:
h = legend('Ref. [8] ','Ref. [21](A = 1.95 ; B = 1.113)','Ref. [21](A = 1.88; B = 1.061)','Optimized n=3','Optimized n=4');
set(h,'location','southeastoutside');
set(gca,'FontSize',50) % Axis Font Setting

hold off
